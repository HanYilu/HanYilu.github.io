!function(){function n(n){return JSON.parse(n)}function e(n){return JSON.stringify(n)}function t(n){return encodeURIComponent(n)}function o(n){return decodeURIComponent(n)}function a(n){return t(e(n))}function c(e){return n(o(e))}function r(n,e){for(var t in e)n[t]=e[t];return console.log(n),n}function s(n,e){return Array.prototype.slice.call(n,e||0)}function u(n,e,t){Object.defineProperty(n,e,{get:t})}function l(n,e){return y++,callbackName="cb_"+y,h[callbackName]=function(){var t=s(arguments);n.apply(v,t),e||(h[callbackName]=null)},callbackName}function f(n){p&&document.documentElement.removeChild(p),p=document.createElement("iframe"),p.setAttribute("width",0),p.style.display="none",p.setAttribute("src",n),document.documentElement.appendChild(p),setTimeout(function(){p&&document.documentElement.removeChild(p),p=null},0)}function d(n){if(/iting/i.test(m)){var e=s(arguments,1),t=e[e.length-1],i=!0,o="ios"==g,a=-1!==n.indexOf("_async"),c=-1!==n.indexOf("_long");if(n=n.replace(/(_async|_long)/g,""),"function"!=typeof t?(i=!1,void 0===t&&(e=e.slice(0,e.length-1))):e=e.slice(0,e.length-1),o||a){var r="null";i&&(r=l(t,c))}if(o){var u="jscall://"+n+"&"+r;try{m.match(/iphone os (\d+\_\d+(\_\d+)*)/)[1].split("_")[0]>=10&&(u=u.replace(/^(jscall:\/\/)/,"$1xmly?"))}catch(d){}if(e)for(var p in e)u+="&"+e[p];f(u)}else{var h=window.jscall[n];if(a)e.unshift(r),h.apply(window.jscall,e);else{var y=h.apply(window.jscall,e);i&&t(y)}}}}var p,h={},y=0,m=navigator.userAgent.toLowerCase(),g=window.jscall?"android":"ios",v={_schemeList:{"default":"iting","com.gemd.iting":"itinggemd","com.qndzq.book":"itingqndzq","com.jima.yijingtingshu":"itingjima"},isAndroid:"android"==g,isIos:"ios"==g,setScheme:function(n){this._schemeList.hasOwnProperty(n)?this.device.scheme=this._schemeList[n]:this.device.scheme=this._schemeList["default"]},device:{name:"",version:"",platformVersion:"",uuid:"",uid:"",token:"",scheme:"iting"},registModule:function(n,e){var t=this;u(e,"$ref",function(){return t}),u(t,n,function(){return e})},toast:function(n){d("notificationToast",t(n))},copy:function(n){d("copy",t(n))},closeWebView:function(){d("closeWebView")},browse:function(n){d("browse",t(n))},login:function(e){d("login_async",function(t){e&&e.call(this,n(t))})},dLogin:function(e){d("dLogin_async",function(t){e&&e.call(this,n(t))})},getNetworkStatus:function(e){d("getNetworkStatus_async",function(t){e&&e.call(this,n(t))})},getVersion:function(){return this.device.version||m.match(/(kdtunion_iting|iting)\/(\d(\.\d{1,3}){2,3})/)[2]},compareVersion:function(n,e){var t=(e||this.getVersion()).split("."),i=(n||"0.0.0").split("."),o=0,a=null,c=function(n,e){var t=parseInt(n,10),i=parseInt(e,10);return t===i?0:t>i?1:-1};return function(n,e){var t=n[o],i=e[o];return!i&&t?void(a=1):!t&&i?void(a=-1):t&&i?0!==c(t,i)?void(a=c(t,i)):(a=0,o++,(e[o]||n[o])&&arguments.callee(n,e),void 0):void(a=0)}(i,t),a},ready:function(n){var e=this;d("appReady",function(t){var i=e.device;t=JSON.parse(t),i.platformVersion=t.platformVersion,i.name=window.jscall?"android":"ios",i.platform=t.platform,i.version=t.version,i.uuid=t.deviceId,i.uid=t.uid,i.token=t.token,i.idfa=t.idfa||"",n.call(e,i)})},config:function(n,e){d("config_async",a(this._wrapFn(n)),function(n){e&&e.call(this,c(n))})},onShare:function(n){n===!1?d("onShare"):d("onShare_async",function(){n&&n.call(this)})},share:function(n,e){d("share_async",a(n),function(n){e&&e.call(this,c(n))})},multiShare:function(n,e){d("multiShare_async",a(n),function(n){e&&e.call(this,c(n))})},_wrapFn:function(n,e){var t=!0;if("boolean"!=typeof e||e||(t=!1),"function"==typeof n)return l(n,t);if("object"==typeof n)for(var i in n)n[i]=this._wrapFn(n[i],e);return n},notify:function(n){d("notifyApp",a(n))},getScheme:function(n,e){var t=this.device.scheme,i=this.paramStr(e);return i.length>0&&(i="&"+i),t+"://open?msg_type="+n+i},open:function(n){/:\/\/open/.test(n)||(n=this.getScheme.apply(this,arguments)),f(n)},paramStr:function(n){var e="",i=null;if(n)for(var o in n)i=n[o],null!=i&&void 0!=i&&(e+="&"+t(o)+"="+t(i));return e.length>0?e.substring(1):""},cookie:function(i,a,c){if(0==arguments.length){var r=this.getQueryParam(null,document.cookie,";");for(var s in r){r[s]=o(r[s]);try{r[s]=n(r[s])}catch(u){}}return r}if(1==arguments.length){var l=o(this.getQueryParam(i,document.cookie,";"));try{return n(l)}catch(u){return l}}else{var f;c=c||{},null==a&&(c.expires=-1),"object"==typeof a&&(a=e(a)),c.expires&&(f=new Date,f.setTime(f.getTime()+1e3*c.expires)),document.cookie=i+"="+t(a)+(c.domain?"; domain="+c.domain:"")+(c.path?"; path="+c.path:"")+(f?"; expires="+f.toUTCString():"")+(c.secure?"; secure":"")}},getQueryParam:function(n,e,t){var i={},o=e||window.location.search.substring(1),a=o.split(t||"&");for(var c in a){var r=a[c].match(/^\s*([%\w]+)=(.*)$/);try{i[r[1]]=r[2]}catch(s){}}return n?i[n]:i},addExtralParam:function(n,e){var e=e||location.href,t=/\?(.[^#]*)/,i="",o={};return(i=e.match(t))?(o=r(this.getQueryParam(null,i[1]),n),e.replace(i[1],this.paramStr(o))):(i=this.paramStr(n),e.indexOf("#")>-1?e.replace(/(#.*)$/,"?"+i+"$1"):e+"?"+i)}};v.registModule("activity",{shareSound:function(n,e,t){d("appShareSound",n,e,t)},shareActivity:function(n,e){d("appShareActivity",n,e)},shareVote:function(n,e,t){d("appShareVote",n,e,t)}}),v.registModule("audio",{play:function(n,e){d("audioPlay",n,function(){e&&e.call(v)})},pause:function(n){d("audioPause",function(){n&&n.call(v)})},playHead:function(n,e){d("playHead_async",a(n),function(n){e&&e.call(this,c(n))})}}),v.registModule("baichuan",{jump:function(n,e){d("bcJump_async",a(n),e)}}),v.registModule("coupon",{useCoupon:function(n){d("useCoupon",n)},shareForCoupon:function(n,e){d("shareForCoupon_async",a(n),function(n){e&&e.call(this,c(n))})}}),v.registModule("image",{captureImage:function(n,e,t){d("captureImage_async",n,e,t)},chooseImage:function(e,t){d("chooseImage_async",a(e),function(e){cb&&cb.call(this,n(data))})},saveImage:function(n){d("saveImage",t(n))}}),v.registModule("payment",{getChannels:function(e){d("getSupportPayType",function(t){e&&e.call(v,n(t))})},pay:function(n,e,t){var i=t,o="xmpay";"string"==typeof e?o=e:i=e,"xmpay"==o?this._xmPay(n,i):"applePay"==o?this._applePay(n,i):this._thirdPay(n,i)},_thirdPay:function(n,e){var t=this.$ref,i="appPay";t.compareVersion("5.4.75")<=0&&(i+="_async"),d(i,a(n),function(t){var i=c(t);i.data=n,e&&e.call(v,i)})},_xmPay:function(n,e){d("xmPay_async",t(n),function(n){e&&e.call(v,o(n))})},_applePay:function(n,e){d("applePay_async",t(n),function(n){e&&e.call(v,o(n))})},payFinished:function(n){n&&this.$ref.compareVersion("4.3.8")<0?d("payFinished",e(n)):d("payFinished")}}),v.registModule("game",{getApkStatus:function(n,e){d("getApkStatus_async_long",a(n),function(n){e&&e.call(this,c(n))})},downloadApk:function(n,e){d("downloadApk_async",a(n),function(n){e&&e.call(this,c(n))})},installApk:function(n,e){d("installApk_async",a(n),function(n){e&&e.call(this,c(n))})},launchApk:function(n,e){d("launchApk_async",a(n),function(n){e&&e.call(this,c(n))})},pauseDownLoad:function(n,e){d("pauseDownLoad_async",a(n),function(n){e&&e.call(this,c(n))})},resumeDownload:function(n,e){d("resumeDownload_async",a(n),function(n){e&&e.call(this,c(n))})}}),v.registModule("recorder",{recorderEvents:{},addRecordText:function(n,e){d("addRecordText_async",a(n),function(){e&&e.apply(this,arguments)})},startRecord:function(n){d("startRecord_async",function(){n&&n.apply(this,arguments)})},pauseRecord:function(n){d("pauseRecord_async",function(){n&&n.apply(this,arguments)})},resumeRecord:function(n,e){d("resumeRecord_async",n,function(){e&&e.apply(this,arguments)})},stopRecord:function(n){d("stopRecord_async",function(){n&&n.apply(this,arguments)})},playVoice:function(n,e){d("playVoice_async",n,function(){e&&e.apply(this,arguments)})},pauseVoice:function(n,e){d("pauseVoice_async",n,function(){e&&e.apply(this,arguments)})},resumeVoice:function(n,e){d("resumeVoice_async",n,function(){e&&e.apply(this,arguments)})},stopVoice:function(n,e){d("stopVoice_async",n,function(){e&&e.apply(this,arguments)})},getUploadProgress:function(n,e){d("getUploadProgress_async",n,function(){e&&e.apply(this,arguments)})},uploadVoice:function(n,e,t,i){d("uploadVoice_async",n,e,t,function(){i&&i.apply(this,arguments)})},_addEvent:function(n,e){var t=this;t.recorderEvents[n]=e,u(this,n,function(){return t.recorderEvents[n].bind(t.$ref)})},bind:function(n,e){if("object"==typeof n)for(i in n)this._addEvent(i,n[i]);else"string"==typeof n&&this._addEvent(n,e)}});var w={onAudioStatusChange:function(n){var e,t=JSON.parse(n);document.createEvent?(e=document.createEvent("CustomEvent"),e.initCustomEvent("audioStatusChange",!0,!0,t),document.dispatchEvent(e)):(e=document.createEventObject(),e.eventType="audioStatusChange",e.detail=t,document.fireEvent("on"+e.eventType,e))},getTitle:function(){var n=document.getElementsByTagName("title")[0],e=n.innerText;return window.jscall&&window.jscall.getTitle?void window.jscall.getTitle(e):e},redirectTo:function(n){window.location.href=n},resizeWin:function(){window.resizeBy(0,0)},getCookie:function(n){var e=v.cookie(n)||"",t={};return t[n]=e,window.jscall&&window.jscall.passCookie?void window.jscall.passCookie(a(t)):e},paySuccess:function(e){var t=n(e),i=v.getQueryParam("fromUrl");return i&&(window.config.paySuccessPage=o(i)),t.status?window.location.href=(window.config.paySuccessPage||"/ting-shang-mobile-web/v1/user/order")+"?orderNo="+t.orderId+"&device="+v.device.name+"&version="+v.device.version:v.toast("支付失败"),""}};v.recorder&&u(w,"recorder",function(){return v.recorder}),window.ya=v,window.nativeCallBack=h,window.nativeCall=w}();